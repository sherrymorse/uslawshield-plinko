<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>U.S. LawShield PLINKO - Admin</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  
  :root {
    --seahawks-navy: #002244;
    --seahawks-green: #69BE28;
    --seahawks-blue: #245998;
    --accent-gold: #FFD700;
    --accent-orange: #FF8C00;
    --accent-red: #FF6B6B;
    --accent-purple: #9B59B6;
    --accent-teal: #1ABC9C;
  }
  
  body {
    font-family: 'Montserrat', sans-serif;
    background: linear-gradient(135deg, var(--seahawks-navy) 0%, var(--seahawks-blue) 50%, var(--seahawks-navy) 100%);
    min-height: 100vh;
    color: white;
    overflow-x: hidden;
    padding: 20px;
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 25px;
  }

  .header {
    grid-column: 1 / -1;
    text-align: center;
    padding: 25px;
    background: linear-gradient(180deg, rgba(0, 34, 68, 0.95) 0%, rgba(41, 128, 185, 0.8) 100%);
    border-bottom: 6px solid var(--accent-gold);
    border-radius: 20px;
    margin-bottom: 20px;
    position: relative;
    overflow: hidden;
  }

  .header::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
      radial-gradient(circle at 20% 80%, rgba(105, 190, 40, 0.2) 0%, transparent 50%),
      radial-gradient(circle at 80% 20%, rgba(255, 215, 0, 0.2) 0%, transparent 50%);
    pointer-events: none;
  }

  .title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 5em;
    letter-spacing: 8px;
    text-shadow: 0 0 40px var(--accent-gold), 4px 4px 0 #000;
    color: white;
    margin-bottom: 10px;
    position: relative;
  }

  .subtitle {
    font-size: 1.6em;
    letter-spacing: 4px;
    color: var(--accent-gold);
    text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    font-weight: 800;
  }

  .setup-panel {
    background: linear-gradient(135deg, rgba(0, 34, 68, 0.9) 0%, rgba(36, 89, 152, 0.9) 100%);
    border-radius: 25px;
    padding: 30px;
    border: 4px solid var(--accent-gold);
    box-shadow: 0 15px 50px rgba(0,0,0,0.6);
  }

  .panel-title {
    color: var(--accent-gold);
    font-size: 28px;
    margin-bottom: 25px;
    text-align: center;
    font-family: 'Bebas Neue', sans-serif;
    letter-spacing: 3px;
    text-transform: uppercase;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
  }

  .form-group {
    margin-bottom: 25px;
  }

  label {
    display: block;
    color: var(--accent-gold);
    margin-bottom: 10px;
    font-weight: 700;
    font-size: 16px;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  input[type="text"], select {
    width: 100%;
    padding: 15px;
    border: 3px solid var(--accent-gold);
    border-radius: 12px;
    background: rgba(0, 25, 51, 0.8);
    color: white;
    font-family: 'Montserrat', sans-serif;
    font-size: 16px;
    font-weight: 600;
    transition: all 0.3s;
  }

  input[type="text"]:focus, select:focus {
    outline: none;
    border-color: var(--seahawks-green);
    box-shadow: 0 0 20px rgba(105, 190, 40, 0.6);
    background: rgba(0, 25, 51, 0.9);
  }

  .board-selection {
    display: flex;
    gap: 12px;
    margin-bottom: 20px;
  }

  .board-option {
    flex: 1;
    text-align: center;
    padding: 15px;
    background: rgba(0, 25, 51, 0.8);
    border: 3px solid var(--accent-gold);
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s;
    color: var(--accent-gold);
    font-weight: 700;
    font-size: 16px;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .board-option:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(255, 215, 0, 0.3);
  }

  .board-option.selected {
    background: var(--accent-gold);
    color: var(--seahawks-navy);
    border-color: var(--seahawks-navy);
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(255, 215, 0, 0.6);
  }

  .puck-config {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
    margin-bottom: 20px;
  }

  .puck-config-item {
    text-align: center;
    padding: 15px;
    background: rgba(0, 25, 51, 0.8);
    border-radius: 12px;
    border: 2px solid var(--accent-gold);
  }

  .puck-config-title {
    color: var(--accent-gold);
    font-weight: 700;
    margin-bottom: 10px;
    font-size: 14px;
    text-transform: uppercase;
  }

  .puck-config-value {
    color: white;
    font-weight: 800;
    font-size: 20px;
  }

  .btn {
    background: linear-gradient(135deg, var(--accent-gold) 0%, var(--accent-orange) 100%);
    color: var(--seahawks-navy);
    padding: 18px 30px;
    border: none;
    border-radius: 50px;
    font-size: 18px;
    font-weight: 800;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 2px;
    border: 3px solid var(--seahawks-navy);
    width: 100%;
    box-shadow: 0 8px 25px rgba(255, 215, 0, 0.5);
  }

  .btn:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 35px rgba(255, 215, 0, 0.8);
    background: linear-gradient(135deg, #FFE55C 0%, #FFA500 100%);
  }

  .btn-cta {
    background: linear-gradient(135deg, var(--seahawks-green) 0%, #4A8A1F 100%);
    font-size: 20px;
    padding: 20px;
    border: 3px solid var(--accent-gold);
    box-shadow: 0 10px 30px rgba(105, 190, 40, 0.6);
  }

  .btn-cta:hover {
    box-shadow: 0 15px 40px rgba(105, 190, 40, 0.9);
    background: linear-gradient(135deg, #7ACF32 0%, #5A9A2F 100%);
  }

  .game-link-section {
    margin-top: 25px;
    padding: 20px;
    background: rgba(0, 25, 51, 0.7);
    border-radius: 15px;
    border: 2px solid var(--accent-gold);
    display: none;
  }

  .link-display {
    display: flex;
    gap: 10px;
    margin-top: 10px;
  }

  .link-display input {
    flex: 1;
    background: rgba(0, 34, 68, 0.9);
    color: var(--accent-gold);
    border: 2px solid var(--accent-gold);
    border-radius: 8px;
    padding: 12px;
    font-weight: 600;
    font-size: 14px;
  }

  .link-display button {
    background: var(--accent-gold);
    color: var(--seahawks-navy);
    border: none;
    border-radius: 8px;
    padding: 12px 20px;
    font-weight: 800;
    cursor: pointer;
    transition: all 0.3s;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .link-display button:hover {
    background: #FFE55C;
    transform: translateY(-2px);
  }

  .notification-panel {
    background: linear-gradient(135deg, rgba(0, 34, 68, 0.9) 0%, rgba(36, 89, 152, 0.9) 100%);
    border-radius: 25px;
    padding: 30px;
    border: 4px solid var(--accent-gold);
    box-shadow: 0 15px 50px rgba(0,0,0,0.6);
    display: flex;
    flex-direction: column;
    height: 100%;
  }

  .notification-list {
    flex: 1;
    overflow-y: auto;
    background: rgba(0, 25, 51, 0.7);
    border-radius: 15px;
    padding: 15px;
    border: 2px solid var(--accent-gold);
  }

  .notification-item {
    background: rgba(0, 34, 68, 0.9);
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 12px;
    border-left: 4px solid var(--accent-gold);
    font-size: 14px;
    line-height: 1.4;
    animation: fadeIn 0.5s ease;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .notification-time {
    color: var(--accent-gold);
    font-size: 12px;
    font-weight: 700;
    margin-top: 5px;
  }

  .prize-summary {
    margin-top: 20px;
    padding: 20px;
    background: rgba(0, 25, 51, 0.7);
    border-radius: 15px;
    border: 2px solid var(--accent-gold);
  }

  .prize-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 10px;
    margin-top: 15px;
  }

  .prize-item {
    background: rgba(0, 34, 68, 0.9);
    padding: 15px;
    border-radius: 10px;
    border: 2px solid var(--accent-gold);
    text-align: center;
    transition: all 0.3s;
  }

  .prize-item:hover {
    transform: translateY(-3px);
    border-color: var(--seahawks-green);
  }

  .prize-symbol {
    font-size: 2em;
    margin-bottom: 8px;
  }

  .prize-name {
    color: var(--accent-gold);
    font-weight: 800;
    font-size: 12px;
    line-height: 1.3;
  }

  .status-indicators {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 15px;
    margin-bottom: 20px;
  }

  .status-item {
    background: rgba(0, 25, 51, 0.8);
    padding: 15px;
    border-radius: 12px;
    text-align: center;
    border: 2px solid var(--accent-gold);
  }

  .status-label {
    color: var(--accent-gold);
    font-weight: 700;
    font-size: 12px;
    text-transform: uppercase;
    margin-bottom: 5px;
  }

  .status-value {
    color: white;
    font-weight: 800;
    font-size: 18px;
  }

  .status-value.connected {
    color: var(--seahawks-green);
  }

  .status-value.waiting {
    color: var(--accent-orange);
  }

  .status-value.playing {
    color: var(--accent-gold);
  }

  .status-value.completed {
    color: var(--accent-teal);
  }

  .admin-controls {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
    margin-top: 20px;
  }

  .admin-btn {
    background: linear-gradient(135deg, var(--accent-red) 0%, #ee5a52 100%);
    color: white;
    padding: 15px;
    border: none;
    border-radius: 12px;
    font-weight: 800;
    cursor: pointer;
    transition: all 0.3s;
    text-transform: uppercase;
    letter-spacing: 1px;
    font-size: 14px;
    box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
    border: 2px solid rgba(255, 255, 255, 0.3);
  }

  .admin-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(255, 107, 107, 0.6);
  }

  .admin-btn.reset {
    background: linear-gradient(135deg, #FF6B6B 0%, #ee5a52 100%);
  }

  .admin-btn.add {
    background: linear-gradient(135deg, var(--seahawks-green) 0%, #4A8A1F 100%);
  }

  .expiration-notice {
    text-align: center;
    margin-top: 15px;
    font-size: 12px;
    color: var(--accent-gold);
    font-weight: 700;
  }
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <h1 class="title">U.S. LAWSHIELD PLINKO</h1>
    <p class="subtitle">ADMIN CONTROL PANEL</p>
  </div>

  <div class="setup-panel">
    <h2 class="panel-title">GAME SETUP</h2>
    
    <div class="form-group">
      <label for="playerName">Player Name:</label>
      <input type="text" id="playerName" placeholder="Enter player name">
    </div>
    
    <div class="form-group">
      <label>Board Configuration:</label>
      <div class="board-selection">
        <div class="board-option" data-board="A">Board A Only</div>
        <div class="board-option" data-board="B">Board B Only</div>
        <div class="board-option selected" data-board="BOTH">Both Boards</div>
      </div>
    </div>
    
    <div class="form-group">
      <label>Puck Configuration:</label>
      <div class="puck-config">
        <div class="puck-config-item">
          <div class="puck-config-title">Board A Pucks</div>
          <div class="puck-config-value">
            <select id="puckCountA">
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="5">5</option>
            </select>
          </div>
        </div>
        <div class="puck-config-item">
          <div class="puck-config-title">Board B Pucks</div>
          <div class="puck-config-value">
            <select id="puckCountB">
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="5">5</option>
            </select>
          </div>
        </div>
      </div>
    </div>
    
    <button class="btn btn-cta" id="createGame">CREATE GAME & GENERATE LINK</button>
    
    <div class="game-link-section" id="gameLinkSection">
      <h3 class="panel-title">PLAYER GAME LINK</h3>
      <p>Copy and share this link with the player:</p>
      <div class="link-display">
        <input type="text" id="gameLink" readonly>
        <button id="copyGameLink">COPY</button>
      </div>
      <div class="expiration-notice">
        ‚è∞ This link will expire in 5 minutes
      </div>
    </div>
  </div>

  <div class="notification-panel">
    <h2 class="panel-title">GAME STATUS & NOTIFICATIONS</h2>
    
    <div class="status-indicators">
      <div class="status-item">
        <div class="status-label">Player Status</div>
        <div class="status-value waiting" id="playerStatus">Waiting</div>
      </div>
      <div class="status-item">
        <div class="status-label">Current Board</div>
        <div class="status-value" id="currentBoard">-</div>
      </div>
      <div class="status-item">
        <div class="status-label">Pucks Remaining</div>
        <div class="status-value" id="pucksRemaining">0</div>
      </div>
    </div>
    
    <div class="notification-list" id="notificationList">
      <div class="notification-item">
        Admin panel initialized and ready
        <div class="notification-time">Just now</div>
      </div>
    </div>
    
    <div class="prize-summary">
      <h3 class="panel-title">PRIZES WON</h3>
      <div class="prize-list" id="wonPrizes">
        <!-- Prizes will appear here as they're won -->
      </div>
    </div>
    
    <div class="admin-controls">
      <button class="admin-btn reset" id="resetGame">RESET GAME</button>
      <button class="admin-btn add" id="addPuck">ADD PUCK</button>
    </div>
  </div>
</div>

<script>
// ==================== JSONBIN.IO CONFIGURATION ====================
const JSONBIN_CONFIG = {
  MASTER_KEY: '$2a$10$NckuWO.y9g8.amyZZWkc8.lKIMS.AVSCyN1qT9/0d5EtRjuV9lmS2',
  ACCESS_KEY: '$2a$10$g6RfQ66H6XQyYy3D848Cfurvs0dXgVt92aV0Rr0UqchZrBZwr7Vpy',
  BASE_URL: 'https://api.jsonbin.io/v3/b',
  HEADERS: {
    'Content-Type': 'application/json',
    'X-Master-Key': '$2a$10$NckuWO.y9g8.amyZZWkc8.lKIMS.AVSCyN1qT9/0d5EtRjuV9lmS2'
  }
};

// ==================== GAME STATE ====================
const gameState = {
  gameId: null,
  playerName: '',
  boardType: 'BOTH',
  pucksA: 1,
  pucksB: 1,
  pucksRemaining: 0,
  currentBoard: 'A',
  prizesWon: [],
  isActive: false,
  playerConnected: false,
  binId: null,
  lastUpdated: 0,
  expirationTime: null,
  boards: {
    A: {
      name: "Board A",
      prizes: [
        { symbol: 'üéÅ', name: '$25 Gift Card', color: '#667eea' },
        { symbol: '‚è∞', name: '1 Hour Campaign', color: '#f093fb' },
        { symbol: 'üë•', name: 'Shadow an Agent', color: '#4facfe' },
        { symbol: 'üö™', name: 'Leave 15min Early', color: '#ff6b6b' },
        { symbol: '‚òï', name: 'Extra 15min Break', color: '#f6d365' },
        { symbol: 'üìä', name: 'Replace QA Score', color: '#4facfe' },
        { symbol: 'üíº', name: 'Coffee with Leadership', color: '#f093fb' },
        { symbol: '‚è∞', name: '1 Hour Campaign', color: '#f093fb' },
        { symbol: 'üéÅ', name: '$25 Gift Card', color: '#667eea' }
      ]
    },
    B: {
      name: "Board B",
      prizes: [
        { symbol: 'üïë', name: '2 Hours Campaign', color: '#9b59b6' },
        { symbol: 'üí∞', name: '$50 Gift Card', color: '#e74c3c' },
        { symbol: '‚è±Ô∏è', name: 'Leave 30min Early', color: '#3498db' },
        { symbol: 'üíØ', name: 'Replace Lowest QA', color: '#2ecc71' },
        { symbol: 'üïì', name: '4 Hours Campaign', color: '#f1c40f' },
        { symbol: 'üçΩÔ∏è', name: 'Lunch with Leadership', color: '#e67e22' },
        { symbol: 'üé¥', name: 'Wild Card', color: '#1abc9c' },
        { symbol: 'üí∞', name: '$50 Gift Card', color: '#e74c3c' },
        { symbol: 'üïë', name: '2 Hours Campaign', color: '#9b59b6' }
      ]
    }
  }
};

// ==================== NOTIFICATION SYSTEM ====================
const notifications = [];

function addNotification(message) {
  const timestamp = new Date().toLocaleTimeString();
  notifications.unshift({
    message,
    timestamp,
    id: Date.now()
  });
  
  // Keep only last 20 notifications
  if (notifications.length > 20) {
    notifications.pop();
  }
  
  updateNotificationDisplay();
}

function updateNotificationDisplay() {
  const notificationList = document.getElementById('notificationList');
  notificationList.innerHTML = '';
  
  notifications.forEach(notif => {
    const item = document.createElement('div');
    item.className = 'notification-item';
    item.innerHTML = `
      ${notif.message}
      <div class="notification-time">${notif.timestamp}</div>
    `;
    notificationList.appendChild(item);
  });
}

function updatePlayerStatus(status) {
  const statusElement = document.getElementById('playerStatus');
  statusElement.textContent = status;
  statusElement.className = `status-value ${status.toLowerCase()}`;
  
  if (status === 'Connected') {
    gameState.playerConnected = true;
    addNotification(`üéÆ Player "${gameState.playerName}" has joined the game`);
  }
}

// ==================== JSONBIN.IO REAL-TIME SYNC ====================
let syncInterval = null;

async function createGameBin(gameState) {
  try {
    const response = await fetch(JSONBIN_CONFIG.BASE_URL, {
      method: 'POST',
      headers: JSONBIN_CONFIG.HEADERS,
      body: JSON.stringify({
        ...gameState,
        created: Date.now(),
        version: 1
      })
    });
    
    const data = await response.json();
    if (data.metadata && data.metadata.id) {
      return data.metadata.id;
    }
    throw new Error('Failed to create bin');
  } catch (error) {
    console.error('Error creating game bin:', error);
    throw error;
  }
}

async function updateGameBin(binId, gameState) {
  try {
    const response = await fetch(`${JSONBIN_CONFIG.BASE_URL}/${binId}`, {
      method: 'PUT',
      headers: JSONBIN_CONFIG.HEADERS,
      body: JSON.stringify({
        ...gameState,
        lastUpdated: Date.now()
      })
    });
    
    const data = await response.json();
    return data.metadata && data.metadata.id;
  } catch (error) {
    console.error('Error updating game bin:', error);
    return false;
  }
}

async function readGameBin(binId) {
  try {
    const response = await fetch(`${JSONBIN_CONFIG.BASE_URL}/${binId}/latest`, {
      headers: {
        'X-Master-Key': JSONBIN_CONFIG.HEADERS['X-Master-Key']
      }
    });
    
    if (!response.ok) throw new Error('Failed to read bin');
    
    const data = await response.json();
    return data.record;
  } catch (error) {
    console.error('Error reading game bin:', error);
    return null;
  }
}

function startSyncInterval(binId) {
  if (syncInterval) clearInterval(syncInterval);
  
  syncInterval = setInterval(async () => {
    if (!binId) return;
    
    const remoteState = await readGameBin(binId);
    if (remoteState && remoteState.lastUpdated > gameState.lastUpdated) {
      // Don't override if we have local changes that are newer
      if (gameState.lastUpdated && gameState.lastUpdated > remoteState.lastUpdated) {
        return;
      }
      
      // Store previous state for comparison
      const prevPrizesWon = [...gameState.prizesWon];
      const prevPucksRemaining = gameState.pucksRemaining;
      const prevCurrentBoard = gameState.currentBoard;
      const prevPlayerConnected = gameState.playerConnected;
      
      // Update from remote state
      Object.keys(remoteState).forEach(key => {
        gameState[key] = remoteState[key];
      });
      
      // Update UI based on changes
      updateGameDisplay();
      
      // Check for new notifications based on state changes
      if (!prevPlayerConnected && gameState.playerConnected) {
        updatePlayerStatus('Connected');
      }
      
      if (prevCurrentBoard !== gameState.currentBoard) {
        document.getElementById('currentBoard').textContent = `Board ${gameState.currentBoard}`;
        addNotification(`üîÑ Player switched to Board ${gameState.currentBoard}`);
      }
      
      if (prevPucksRemaining !== gameState.pucksRemaining) {
        if (prevPucksRemaining > gameState.pucksRemaining) {
          updatePlayerStatus('Playing');
          addNotification('üé≤ Player dropped a puck');
        }
      }
      
      if (prevPrizesWon.length < gameState.prizesWon.length) {
        const newPrize = gameState.prizesWon[gameState.prizesWon.length - 1];
        addNotification(`üéâ Player won: ${newPrize.prize} (Board ${newPrize.board})`);
        updatePlayerStatus('Won Prize');
        
        // If all pucks used, game is complete
        if (gameState.pucksRemaining === 0) {
          updatePlayerStatus('Completed');
          addNotification('üèÅ Player completed the game!');
        }
      }
    }
  }, 2000);
}

function stopSyncInterval() {
  if (syncInterval) {
    clearInterval(syncInterval);
    syncInterval = null;
  }
}

async function saveGameStateToCloud() {
  if (!gameState.binId) return false;
  
  gameState.lastUpdated = Date.now();
  const success = await updateGameBin(gameState.binId, gameState);
  return success;
}

// ==================== GAME CONTROLS ====================
async function createGame() {
  const playerName = document.getElementById('playerName').value.trim();
  const boardType = document.querySelector('.board-option.selected').dataset.board;
  const pucksA = parseInt(document.getElementById('puckCountA').value);
  const pucksB = parseInt(document.getElementById('puckCountB').value);
  
  if (!playerName) {
    alert('Please enter a player name');
    return;
  }
  
  // Update game state
  gameState.playerName = playerName;
  gameState.boardType = boardType;
  gameState.pucksA = pucksA;
  gameState.pucksB = pucksB;
  gameState.pucksRemaining = boardType === 'BOTH' ? pucksA : (boardType === 'A' ? pucksA : pucksB);
  gameState.currentBoard = boardType === 'B' ? 'B' : 'A';
  gameState.prizesWon = [];
  gameState.isActive = true;
  gameState.playerConnected = false;
  gameState.gameId = 'G' + Date.now().toString().slice(-6);
  gameState.lastUpdated = Date.now();
  gameState.expirationTime = Date.now() + 5 * 60 * 1000; // 5 minutes from now

  try {
    // Create cloud storage
    gameState.binId = await createGameBin(gameState);
    
    // Start synchronization
    startSyncInterval(gameState.binId);
    
    // Generate and show game link
    const gameLink = `${window.location.origin}${window.location.pathname}?game=${gameState.binId}`;
    document.getElementById('gameLink').value = gameLink;
    document.getElementById('gameLinkSection').style.display = 'block';
    
    // Update UI
    updateGameDisplay();
    updatePlayerStatus('Waiting');
    
    // Add notification
    addNotification(`üéÆ Game created for "${playerName}"`);
    addNotification(`üìã Board configuration: ${boardType === 'BOTH' ? 'Both Boards' : `Board ${boardType}`}`);
    addNotification(`üéØ Pucks: ${pucksA} for Board A, ${pucksB} for Board B`);
    addNotification('üîó Game link generated - share with player');
    
  } catch (error) {
    console.error('Failed to create cloud game:', error);
    alert('Failed to create cloud game. Please try again.');
  }
}

function updateGameDisplay() {
  document.getElementById('pucksRemaining').textContent = gameState.pucksRemaining;
  document.getElementById('currentBoard').textContent = `Board ${gameState.currentBoard}`;
  
  // Update won prizes display
  const wonPrizesElement = document.getElementById('wonPrizes');
  wonPrizesElement.innerHTML = '';
  
  gameState.prizesWon.forEach(prize => {
    const prizeElement = document.createElement('div');
    prizeElement.className = 'prize-item';
    prizeElement.innerHTML = `
      <div class="prize-symbol">${prize.symbol}</div>
      <div class="prize-name">${prize.prize}</div>
    `;
    wonPrizesElement.appendChild(prizeElement);
  });
}

// ==================== EVENT HANDLERS ====================
document.addEventListener('DOMContentLoaded', function() {
  // Board selection
  document.querySelectorAll('.board-option').forEach(option => {
    option.addEventListener('click', () => {
      document.querySelectorAll('.board-option').forEach(opt => opt.classList.remove('selected'));
      option.classList.add('selected');
    });
  });
  
  // Create game button
  document.getElementById('createGame').addEventListener('click', createGame);
  
  // Copy game link button
  document.getElementById('copyGameLink').addEventListener('click', () => {
    const gameLink = document.getElementById('gameLink');
    gameLink.select();
    document.execCommand('copy');
    addNotification('üìã Game link copied to clipboard');
  });
  
  // Reset game button
  document.getElementById('resetGame').addEventListener('click', async () => {
    if (confirm('Reset the game? This will clear all progress and prizes.')) {
      gameState.prizesWon = [];
      gameState.pucksRemaining = gameState.boardType === 'BOTH' ? gameState.pucksA : 
                                (gameState.boardType === 'A' ? gameState.pucksA : gameState.pucksB);
      gameState.currentBoard = gameState.boardType === 'B' ? 'B' : 'A';
      gameState.playerConnected = false;
      
      await saveGameStateToCloud();
      updateGameDisplay();
      updatePlayerStatus('Waiting');
      addNotification('üîÑ Game reset by admin');
    }
  });
  
  // Add puck button
  document.getElementById('addPuck').addEventListener('click', async () => {
    gameState.pucksRemaining++;
    await saveGameStateToCloud();
    updateGameDisplay();
    addNotification('‚ûï Admin added an extra puck');
  });
  
  // Initial notification
  addNotification('Admin panel initialized and ready');
});
</script>
</body>
</html>
