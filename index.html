<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>U.S. LawShield PLINKO – Seahawks Edition</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Oswald:wght@600;800&display=swap" rel="stylesheet">
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  
  body {
    font-family: 'Oswald', sans-serif;
    background: linear-gradient(135deg, #002244 0%, #003366 50%, #002244 100%);
    min-height: 100vh;
    color: white;
    overflow-x: hidden;
    position: relative;
  }

  /* Seahawks pattern overlay */
  body::before {
    content: "";
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: 
      radial-gradient(circle at 20% 80%, rgba(105, 190, 40, 0.1) 0%, transparent 50%),
      radial-gradient(circle at 80% 20%, rgba(105, 190, 40, 0.1) 0%, transparent 50%),
      radial-gradient(circle at 40% 40%, rgba(0, 86, 184, 0.1) 0%, transparent 50%);
    pointer-events: none;
    z-index: -1;
  }

  .header {
    text-align: center;
    padding: 30px 20px;
    background: linear-gradient(180deg, rgba(0, 34, 68, 0.9) 0%, rgba(0, 34, 68, 0.7) 100%);
    border-bottom: 6px solid #69BE28;
    position: relative;
    overflow: hidden;
  }

  .header::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
      linear-gradient(45deg, transparent 45%, rgba(105, 190, 40, 0.1) 50%, transparent 55%),
      linear-gradient(-45deg, transparent 45%, rgba(105, 190, 40, 0.1) 50%, transparent 55%);
    background-size: 60px 60px;
    z-index: 0;
  }

  .title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 5em;
    letter-spacing: 8px;
    text-shadow: 0 0 30px #69BE28, 4px 4px 0 #000;
    color: white;
    position: relative;
    z-index: 1;
  }

  .subtitle {
    font-size: 1.6em;
    letter-spacing: 4px;
    color: #69BE28;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    position: relative;
    z-index: 1;
    margin-top: 10px;
  }

  .game-container {
    max-width: 1200px;
    margin: 30px auto;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 30px;
    padding: 0 20px;
  }

  .plinko-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
  }

  .canvas-wrapper {
    position: relative;
    border-radius: 25px;
    overflow: hidden;
    box-shadow: 
      0 0 80px rgba(105, 190, 40, 0.6),
      inset 0 0 60px rgba(0, 0, 0, 0.8);
    border: 12px solid #002244;
    background: #001933;
  }

  #c {
    display: block;
    background: #001933;
  }

  .canvas-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    pointer-events: none;
    background: 
      linear-gradient(90deg, rgba(0, 25, 51, 0.4) 0%, transparent 20%, transparent 80%, rgba(0, 25, 51, 0.4) 100%),
      radial-gradient(circle at 50% 0%, rgba(105, 190, 40, 0.1) 0%, transparent 50%);
  }

  .drop-zone {
    background: linear-gradient(135deg, #69BE28 0%, #4A8A1F 100%);
    padding: 20px 40px;
    border-radius: 20px;
    font-size: 28px;
    font-weight: 800;
    box-shadow: 0 15px 40px rgba(105, 190, 40, 0.7);
    border: 4px solid #002244;
    color: #002244;
    text-align: center;
    min-width: 300px;
    position: relative;
    animation: pulse-glow 2s infinite;
  }

  @keyframes pulse-glow {
    0%, 100% { box-shadow: 0 15px 40px rgba(105, 190, 40, 0.7); }
    50% { box-shadow: 0 20px 60px rgba(105, 190, 40, 1); }
  }

  .prompt {
    position: absolute;
    top: -35px;
    left: 50%;
    transform: translateX(-50%);
    background: #002244;
    padding: 8px 20px;
    border-radius: 20px;
    font-size: 18px;
    white-space: nowrap;
    font-weight: 600;
    border: 2px solid #69BE28;
    color: #69BE28;
  }

  .controls-section {
    display: flex;
    flex-direction: column;
    gap: 25px;
    min-width: 350px;
  }

  .btn {
    background: linear-gradient(135deg, #69BE28 0%, #4A8A1F 100%);
    color: #002244;
    padding: 18px 40px;
    border: none;
    border-radius: 50px;
    font-size: 24px;
    font-weight: 800;
    cursor: pointer;
    box-shadow: 0 10px 30px rgba(105, 190, 40, 0.6);
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 1px;
    border: 3px solid #002244;
  }

  .btn:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 40px rgba(105, 190, 40, 0.9);
    background: linear-gradient(135deg, #7ACF32 0%, #5A9A2F 100%);
  }

  .stats-panel {
    background: linear-gradient(135deg, rgba(0, 34, 68, 0.9) 0%, rgba(0, 51, 102, 0.9) 100%);
    padding: 30px;
    border-radius: 25px;
    text-align: center;
    border: 4px solid #69BE28;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
  }

  .stats-panel h3 {
    color: #69BE28;
    font-size: 28px;
    margin-bottom: 20px;
    text-transform: uppercase;
    letter-spacing: 2px;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
  }

  .stat-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
  }

  .stat-item {
    background: rgba(0, 25, 51, 0.7);
    padding: 15px;
    border-radius: 15px;
    border: 2px solid #69BE28;
  }

  .stat-value {
    font-size: 32px;
    font-weight: 800;
    color: #69BE28;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
  }

  .stat-label {
    font-size: 16px;
    color: #A5ACAF;
    margin-top: 5px;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .status {
    position: fixed;
    top: 15px;
    right: 15px;
    background: rgba(0, 34, 68, 0.9);
    padding: 12px 25px;
    border-radius: 25px;
    font-size: 16px;
    border: 2px solid #69BE28;
    color: #69BE28;
    z-index: 1000;
  }

  .bigwin {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0);
    font-size: 8em;
    color: #69BE28;
    text-shadow: 0 0 50px #69BE28, 0 0 100px #69BE28;
    z-index: 9999;
    pointer-events: none;
    animation: win 2s forwards;
    font-family: 'Bebas Neue', sans-serif;
    letter-spacing: 8px;
  }

  @keyframes win {
    0% { transform: translate(-50%, -50%) scale(0) rotate(-180deg); opacity: 0; }
    50% { transform: translate(-50%, -50%) scale(1.5); opacity: 1; }
    100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
  }

  /* Seahawks feather pattern decoration */
  .feather-decoration {
    position: absolute;
    width: 200px;
    height: 100px;
    background: linear-gradient(45deg, transparent 45%, #69BE28 50%, transparent 55%);
    opacity: 0.1;
    z-index: 0;
  }

  .feather-1 { top: 10%; left: 5%; transform: rotate(45deg); }
  .feather-2 { bottom: 10%; right: 5%; transform: rotate(-135deg); }

  @media (max-width: 768px) {
    .game-container {
      flex-direction: column;
      align-items: center;
    }
    
    .controls-section {
      width: 100%;
    }
    
    .title {
      font-size: 3em;
    }
    
    .subtitle {
      font-size: 1.2em;
    }
  }
</style>
</head>
<body>
<div class="feather-decoration feather-1"></div>
<div class="feather-decoration feather-2"></div>

<div class="status" id="status">Connecting to cloud…</div>
<div class="header">
  <h1 class="title">U.S. LAWSHIELD PLINKO</h1>
  <p class="subtitle">LEGAL DEFENSE FOR SELF DEFENSE®</p>
</div>

<div class="game-container">
  <div class="plinko-section">
    <div class="canvas-wrapper">
      <canvas id="c" width="720" height="1080"></canvas>
      <div class="canvas-overlay"></div>
    </div>
    <div class="drop-zone">
      DROP ZONE
      <div class="prompt">Hold mouse down on the disc to grab & position – release to drop!</div>
    </div>
  </div>
  
  <div class="controls-section">
    <button class="btn" onclick="earnDisc()">Earn New Disc</button>
    
    <div class="stats-panel">
      <h3>Player Stats</h3>
      <div class="stat-grid">
        <div class="stat-item">
          <div class="stat-value" id="total">0</div>
          <div class="stat-label">Total Winnings</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="best">0</div>
          <div class="stat-label">Best Drop</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="played">0</div>
          <div class="stat-label">Discs Played</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="avail">0</div>
          <div class="stat-label">Discs Available</div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// ==================== JSONBIN.IO CLOUD ====================
const MASTER_KEY = "$2a$10$NckuWO.y9g8.amyZZWkc8.lKIMS.AVSCyN1qT9/0d5EtRjuV9lmS2";
const BIN_URL = "https://api.jsonbin.io/v3/b";
let BIN_ID = localStorage.getItem("plinko_bin_id") || null;
let cloud = {employees:{},activities:[]};

async function loadCloud(){
  try{
    if(!BIN_ID) throw "no bin";
    const r = await fetch(`${BIN_URL}/${BIN_ID}/latest`,{headers:{'X-Master-Key':MASTER_KEY}});
    cloud = await r.json() || cloud;
    document.getElementById("status").textContent="Cloud Connected";
  }catch(e){
    const r = await fetch(BIN_URL,{method:"POST",headers:{'Content-Type':'application/json','X-Master-Key':MASTER_KEY,'X-Bin-Name':'USLawShield-Plinko'},body:JSON.stringify(cloud)});
    const j = await r.json();
    BIN_ID = j.metadata.id;
    localStorage.setItem("plinko_bin_id",BIN_ID);
    document.getElementById("status").textContent="Cloud Created";
  }
}

async function saveCloud(){
  if(!BIN_ID) return;
  await fetch(`${BIN_URL}/${BIN_ID}`,{method:"PUT",headers:{'Content-Type':'application/json','X-Master-Key':MASTER_KEY},body:JSON.stringify(cloud)});
}

// ==================== EMPLOYEE & STATE ====================
let employeeId = localStorage.getItem("empId");
let name = localStorage.getItem("empName");
if(!name){ name = prompt("Welcome! Enter your name:") || "Player"; localStorage.setItem("empName",name); }
if(!employeeId){ employeeId = "emp_"+Date.now(); localStorage.setItem("empId",employeeId); }
if(!cloud.employees[employeeId]) cloud.employees[employeeId] = {name,total:0,best:0,played:0,discs:0,used:0};
let p = cloud.employees[employeeId];

// ==================== PLINKO PHYSICS ====================
const canvas = document.getElementById('c'), ctx = canvas.getContext('2d');
const W = canvas.width, H = canvas.height;
const DROP_H = 120, DISC_R = 30, PEG_R = 8;
const ROWS = 16, SLOTS = 9;
const VALUES = [100,500,1000,0,10000,0,1000,500,100];

// Seahawks color scheme for slots
const SLOT_COLORS = [
  '#002244', '#002244', '#002244',  // Navy for 100, 500, 1000
  '#7f1d1d',                        // Dark red for 0
  '#69BE28',                        // Action Green for 10000
  '#7f1d1d',                        // Dark red for 0
  '#002244', '#002244', '#002244'   // Navy for 1000, 500, 100
];

let pegs = [], disc = null, trail = [], particles = [], time = 0;
let hovering = {x:W/2, y:DROP_H/2, speed:1.5, amp: W/2 - DISC_R - 50};
let dragging = false;

function initPegs(){
  const startY = DROP_H + 90;
  const rowH = (H - 240 - startY) / ROWS;
  const colW = W / 10;
  for(let r=0;r<ROWS;r++){
    const cols = r%2===0?9:10;
    const offset = r%2===0?colW:colW/2;
    for(let c=0;c<cols;c++){
      pegs.push({x:offset+c*colW,y:startY+r*rowH});
    }
  }
}
initPegs();

function draw(){
  time += 0.016;
  
  // Board background with subtle pattern
  ctx.fillStyle="#001933";
  ctx.fillRect(0,0,W,H);
  
  // Add subtle grid pattern
  ctx.strokeStyle = "rgba(105, 190, 40, 0.05)";
  ctx.lineWidth = 1;
  for(let x=0; x<W; x+=40){
    ctx.beginPath();
    ctx.moveTo(x,0);
    ctx.lineTo(x,H);
    ctx.stroke();
  }
  for(let y=0; y<H; y+=40){
    ctx.beginPath();
    ctx.moveTo(0,y);
    ctx.lineTo(W,y);
    ctx.stroke();
  }
  
  // Drop zone with Seahawks colors
  const grad = ctx.createLinearGradient(0,0,0,DROP_H);
  grad.addColorStop(0,"#69BE28");
  grad.addColorStop(1,"#4A8A1F");
  ctx.fillStyle=grad;
  ctx.fillRect(0,0,W,DROP_H);
  
  // Drop zone border
  ctx.strokeStyle="#002244";
  ctx.lineWidth=6;
  ctx.strokeRect(0,0,W,DROP_H);
  
  // Drop zone text
  ctx.fillStyle="#002244";
  ctx.font="bold 38px Oswald";
  ctx.textAlign="center";
  ctx.fillText("DROP ZONE",W/2,DROP_H/2+15);
  
  // Pegs with Seahawks colors
  pegs.forEach(p=>{
    const g = ctx.createRadialGradient(p.x-4,p.y-4,0,p.x,p.y,PEG_R);
    g.addColorStop(0,"#69BE28");
    g.addColorStop(1,"#4A8A1F");
    ctx.fillStyle=g;
    ctx.beginPath();
    ctx.arc(p.x,p.y,PEG_R,0,Math.PI*2);
    ctx.fill();
    
    // Peg glow
    ctx.shadowColor = "#69BE28";
    ctx.shadowBlur = 10;
    ctx.fill();
    ctx.shadowBlur = 0;
  });
  
  // Slots with Seahawks colors
  const sh=130, sw=W/SLOTS;
  VALUES.forEach((v,i)=>{
    ctx.fillStyle = SLOT_COLORS[i];
    ctx.fillRect(i*sw,H-sh,sw,sh);
    
    // Slot borders
    ctx.strokeStyle="#69BE28";
    ctx.lineWidth=5;
    ctx.strokeRect(i*sw,H-sh,sw,sh);
    
    // Slot text
    ctx.fillStyle="white";
    ctx.font="bold 26px Oswald";
    ctx.textAlign="center";
    ctx.fillText(v===0?"0":"$"+v,i*sw+sw/2,H-sh/2+8);
  });
  
  // Hovering disc (only when available and not falling)
  const avail = p.discs - p.used;
  if(avail > 0 && !disc && !dragging){
    hovering.x = W/2 + Math.sin(time * hovering.speed) * hovering.amp;
    drawDisc(hovering.x, hovering.y, Math.sin(time*2)*0.15);
  }
  
  // Trail
  trail.forEach((t,i)=>{
    ctx.globalAlpha=i/trail.length*0.5;
    ctx.fillStyle="#69BE28";
    ctx.beginPath();
    ctx.arc(t.x,t.y,DISC_R*0.8,0,Math.PI*2);
    ctx.fill();
  });
  ctx.globalAlpha=1;
  
  // Active disc (dragging or falling)
  if(disc){
    drawDisc(disc.x, disc.y, disc.spin);
  }
  
  // Particles
  particles = particles.filter(pa=>{
    pa.y -= pa.vy;
    pa.life--;
    ctx.globalAlpha = pa.life/50;
    ctx.fillStyle=pa.color;
    ctx.beginPath();
    ctx.arc(pa.x+Math.sin(pa.life)*25,pa.y,12,0,Math.PI*2);
    ctx.fill();
    return pa.life>0;
  });
  ctx.globalAlpha=1;
}

function drawDisc(x,y,spin=0){
  ctx.save();
  ctx.translate(x,y);
  ctx.rotate(spin);
  
  // Disc with Seahawks colors
  const g = ctx.createRadialGradient(-9,-9,0,0,0,DISC_R);
  g.addColorStop(0,"#69BE28");
  g.addColorStop(0.7,"#4A8A1F");
  g.addColorStop(1,"#002244");
  ctx.fillStyle=g;
  ctx.beginPath();
  ctx.arc(0,0,DISC_R,0,Math.PI*2);
  ctx.fill();
  
  // Disc border
  ctx.strokeStyle="#002244";
  ctx.lineWidth=3;
  ctx.stroke();
  
  // Disc details
  ctx.fillStyle="#002244";
  ctx.beginPath();
  ctx.arc(-9,-9,DISC_R*0.4,0,Math.PI*2);
  ctx.fill();
  
  ctx.fillStyle="white";
  ctx.font="bold 18px Oswald";
  ctx.textAlign="center";
  ctx.fillText("USL",0,6);
  
  ctx.restore();
}

// Hover + drag logic
canvas.addEventListener("mousemove",(e)=>{
  const r = canvas.getBoundingClientRect();
  const mx = e.clientX - r.left, my = e.clientY - r.top;
  const avail = p.discs - p.used;
  const hx = hovering.x, hy = hovering.y;
  const nearHover = avail > 0 && !disc && !dragging && Math.hypot(mx-hx,my-hy) < DISC_R*1.3;
  
  if(nearHover) canvas.style.cursor = "grab";
  else if(dragging) canvas.style.cursor = "grabbing";
  else canvas.style.cursor = "default";
  
  if(dragging && disc){
    disc.x = Math.max(DISC_R+30, Math.min(W-DISC_R-30, mx));
    disc.y = Math.max(30, Math.min(DROP_H-30, my));
    draw();
  }
});

canvas.addEventListener("mousedown",(e)=>{
  const r = canvas.getBoundingClientRect();
  const mx = e.clientX - r.left, my = e.clientY - r.top;
  const avail = p.discs - p.used;
  
  if(avail > 0 && !disc && Math.hypot(mx-hovering.x,my-hovering.y) < DISC_R*1.3){
    dragging = true;
    canvas.style.cursor = "grabbing";
    disc = {x:mx, y:my, vx:0, vy:0, spin:0, spinV:0};
    draw();
  }
});

canvas.addEventListener("mouseup",(e)=>{
  if(!dragging) return;
  dragging = false;
  canvas.style.cursor = "default";
  
  if(disc && disc.y <= DROP_H){
    disc.vx = (Math.random()-0.5)*80;
    disc.vy = 0;
    disc.spinV = (Math.random()-0.5)*0.8;
    trail = [];
    p.used++;
    document.getElementById("avail").textContent = p.discs - p.used;
    saveCloud();
    requestAnimationFrame(physics);
  }else{
    disc = null;
  }
  draw();
});

canvas.addEventListener("mouseleave",()=>{
  if(dragging){
    dragging=false;
    disc=null;
    draw();
  }
});

// Physics loop
function physics(){
  if(!disc) return;
  
  disc.vy += 520;
  disc.vx *= 0.993;
  disc.vy *= 0.993;
  disc.x += disc.vx * 0.016;
  disc.y += disc.vy * 0.016;
  disc.spin += disc.spinV;
  disc.spinV *= 0.99;
  
  trail.push({x:disc.x,y:disc.y});
  if(trail.length>40) trail.shift();
  
  pegs.forEach(p=>{
    const dx=disc.x-p.x, dy=disc.y-p.y, d=Math.hypot(dx,dy);
    if(d < DISC_R+PEG_R){
      const nx=dx/d, ny=dy/d;
      const dot = disc.vx*nx + disc.vy*ny;
      disc.vx -= 2.1*dot*nx*0.78;
      disc.vy -= 2.1*dot*ny*0.78;
      disc.spinV += (Math.random()-0.5)*0.7;
      disc.vx += (Math.random()-0.5)*45;
      
      const overlap = DISC_R+PEG_R-d;
      disc.x += nx*overlap*1.2;
      disc.y += ny*overlap*1.2;
    }
  });
  
  if(disc.x < DISC_R+30){
    disc.x = DISC_R+30;
    disc.vx = Math.abs(disc.vx)*0.8;
  }
  if(disc.x > W-DISC_R-30){
    disc.x = W-DISC_R-30;
    disc.vx = -Math.abs(disc.vx)*0.8;
  }
  
  if(disc.y > H-150){
    const slot = Math.floor(disc.x / (W/SLOTS));
    const win = VALUES[Math.min(Math.max(slot,0),8)];
    p.total += win;
    p.best = Math.max(p.best,win);
    p.played++;
    
    document.getElementById("total").textContent = p.total;
    document.getElementById("best").textContent = p.best;
    document.getElementById("played").textContent = p.played;
    
    if(win >= 1000){
      const el = document.createElement("div");
      el.className="bigwin";
      el.textContent = "$"+win+"!";
      document.body.appendChild(el);
      setTimeout(()=>el.remove(),3000);
      
      for(let i=0;i<100;i++) particles.push({
        x:disc.x,
        y:H-120,
        vy:Math.random()*14+8,
        life:60,
        color:"#69BE28"
      });
    }
    saveCloud();
    disc = null;
    trail = [];
  }
  
  draw();
  if(disc) requestAnimationFrame(physics);
}

// Earn disc
function earnDisc(){
  const acts = ["Single PR","Dual PR","Monthly LOC","Annual LOC","Save","Winback","Add E-Shield","Conversion"];
  const act = prompt("Activity completed:\n\n"+acts.map((a,i)=>`${i+1}. ${a}`).join("\n")+"\n\nEnter number or name:");
  const mid = prompt("Member ID (e.g. TX123456):")?.toUpperCase();
  
  if(act && mid && /^[A-Z]{2,3}\d+$/.test(mid)){
    p.discs++;
    cloud.activities.push({employeeId,name,activity:act,memberId:mid,time:Date.now()});
    document.getElementById("avail").textContent = p.discs - p.used;
    saveCloud();
    alert("Disc earned! Hover over the green disc to grab it.");
    draw();
  }else alert("Invalid – try again");
}

// Init
loadCloud().then(()=>{
  p.discs = p.discs||0;
  p.used = p.used||0;
  document.getElementById("total").textContent = p.total;
  document.getElementById("best").textContent = p.best;
  document.getElementById("played").textContent = p.played;
  document.getElementById("avail").textContent = p.discs - p.used;
  
  requestAnimationFrame(()=>{
    draw();
    requestAnimationFrame(()=>{
      draw();
    });
  });
});
</script>
</body>
</html>
